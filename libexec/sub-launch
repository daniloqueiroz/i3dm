#!/usr/bin/env bash
# Usage: i3dm launch [option]
# Summary: App/file launcher & window switcher
# Help: The following options are available
# -p/pass - password store mode
# -w/window - switch window mode
# -a/app - launch app mode

set -e
set -x

source ${libs_file}

DMENU_PARAMS="-b -i -p ‚ùØ -nb #0C1923 -nf #005D69 -sb #0C1923 -sf #00BCD4"

function launcher() {
  case "$command" in
    "apps" | "-a")
      i3-dmenu-desktop --dmenu="dmenu ${DMENU_PARAMS}"
      ;;
    "pass" | "-p")
      passmenu --type ${DMENU_PARAMS}
      ;;
    "windows" | "-w")
      quickswitch --dmenu="dmenu ${DMENU_PARAMS}"
      ;;
    "suspend")
      systemctl suspend
      ;;
    "kill")
      processList=$(ps -u $(whoami) -o pid= -o comm=)
      selection=$(echo -e "$processList" | dmenu ${DMENU_PARAMS})
      [[ -z "$selection" ]] && exit

      pid=$(awk '{print $1}' <<< "$selection" | tr '\n' ' ')
      [[ -z "$pid" ]] && exit

      kill "$pid"
      ;;
    *)
      list=("apps\npass\nwindows\nfile\nsuspend\nkill")
      command=$(echo -e "$list" | dmenu ${DMENU_PARAMS})
      launcher
      ;;
  esac
}

command=$1
launcher
